---
title: "example"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{example}
  %\VignetteEncoding{UTF-8}
  %\VignetteEngine{knitr::rmarkdown}
editor_options: 
  chunk_output_type: console
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
rm(list=ls())
library(imprecise101)
```

## Examples 

We draw a sequence of marbles whose colours are (in order): blue, green, blue, blue, green, red. What conclusions can you reach about the probability of drawing a red marble on a future trial? 

If $\Omega = \{R, B, G, O\}$, then $n = (1, 3, 2, 0)$ and $L(\theta|n) \propto \theta_R \theta_B^3 \theta_G^2$. 

### 4.1. Probabilities of Future Outcomes 

The simplest way of stating our conclusion is to report the posterior upper and lower probabilities of obtaining red on the next trial. 

Using $s=2$, $\overline{P}(R|n)=0.375$ and $\underline{P}(R|n)=0.125$
```{r}
op <- idm(nj=1, s=2, N=6, k=4)
c(op$p.lower, op$p.upper)
```

For $s=1$, $\overline{P}(R|n)=0.286$ and $\underline{P}(R|n)=0.143$. 
```{r}
op <- idm(nj=1, s=1, N=6, k=4)
round(c(op$p.lower, op$p.upper),3)
```

For the improper prior density ($s=0$) which gives $P(R|n)=0.167$ irrespective of $\Omega$. 

```{r}
op <- idm(nj=1, s=0, N=6, k=4)
round(c(op$p.lower, op$p.upper),3)
```

Three possible sample spaces are $\Omega_1=\{R,B,G,O\}$, $\Omega_2=\{R, O\}$, and $\Omega_3=\{LR, DR, O\}$. The parameter values $s=1,2,k/2$, and $k$, where $k$ is the number of elements in $\Omega$. 

```{r}
# Omega1
idm(nj=1, s=1, N=6, k=4)$p
idm(nj=1, s=2, N=6, k=4)$p
idm(nj=1, s=4/2, N=6, k=4)$p
idm(nj=1, s=4, N=6, k=4)$p

# Omega2
idm(nj=1, s=1, N=6, k=2)$p
idm(nj=1, s=2, N=6, k=2)$p
idm(nj=1, s=2/2, N=6, k=2)$p
idm(nj=1, s=2, N=6, k=2)$p

# Omega3
idm(nj=1, s=1, N=6, k=3, cA=2)$p
idm(nj=1, s=2, N=6, k=3, cA=2)$p
idm(nj=1, s=3/2, N=6, k=3, cA=2)$p
idm(nj=1, s=3, N=6, k=3, cA=2)$p

```

Inferences can also be made about the number of red marbles that will be drawn in $M$ future trials. 

```{r}
mat <- rbind(
  unlist(pbetabinom(M=6, x=1, s=1, N=6, y=0)),
  unlist(pbetabinom(M=6, x=1, s=1, N=6, y=1)),
  unlist(pbetabinom(M=6, x=1, s=1, N=6, y=2)),
  unlist(pbetabinom(M=6, x=1, s=1, N=6, y=3)),
  unlist(pbetabinom(M=6, x=1, s=1, N=6, y=4)),
  unlist(pbetabinom(M=6, x=1, s=1, N=6, y=5)),
  unlist(pbetabinom(M=6, x=1, s=1, N=6, y=6))
)
rownames(mat) <- c("y=0", "y=1", "y=2", "y=3", "y=4", "y=5", "y=6")
round(mat, 3)
```

### 4.2 Means and Standard Deviations for $\theta_R$

Taking $s=2$, $\overline{E}(\theta_R|n) = 0.375$, $\underline{E}(\theta_R|n)=0.125$, $\overline{\sigma}(\theta_R|n)=0.188$, and $\underline{\sigma}(\theta_R|n)=0.110$. 

Taking $s=1$, $\overline{E}(\theta_R|n) = 0.286$, $\underline{E}(\theta_R|n)=0.143$, $\overline{\sigma}(\theta_R|n)=0.164$, and $\underline{\sigma}(\theta_R|n)=0.124$. 

```{r}
op <- idm(nj=1, s=2, N=6, k=4)
round(c(op$p.upper, op$p.lower, op$s.upper, op$s.lower),3)

op <- idm(nj=1, s=1, N=6, k=4)
round(c(op$p.upper, op$p.lower, op$s.upper, op$s.lower),3)
```

### 4.3 Credible Intervals for $\theta_R$

```{r}
round(hpd(alpha=3, beta=5, p=0.95),4) # s=2
round(hpd(alpha=3, beta=5, p=0.90),4) # s=2
round(hpd(alpha=3, beta=5, p=0.50),4) # s=2
round(hpd(alpha=2, beta=5, p=0.95),4) # s=1
round(hpd(alpha=2, beta=5, p=0.90),4) # s=1
round(hpd(alpha=2, beta=5, p=0.50),4) # s=1
```

### 4.4 Testing Hypotheses about $\theta_R$

